var branchLocations={ballentine:{address:"1200 Dutch Fork Rd, Irmo, SC 29063",latitude:34.127259,longitude:-81.227182},blythewood:{address:"218 McNulty St, Blythewood, SC 29016",latitude:34.216132,longitude:-80.976817},cooper:{address:"5317 N Trenholm Rd, Columbia, SC 29206",latitude:34.021546,longitude:-80.966601},eastover:{address:"608 Main St, Eastover, SC 29044",latitude:33.877196,longitude:-80.694748},edgewood:{address:"2101 Oak St, Columbia, SC 29204",latitude:34.017926,longitude:-81.021301},
edventure:{address:"211 Gervais St, Columbia, SC 29201",latitude:33.997307,longitude:-81.048043},lowerrichland:{address:"9019 Garners Ferry Rd, Hopkins, SC 29061",latitude:33.9452902,longitude:-80.8723545},main:{address:"1431 Assembly St, Columbia, SC 29201",latitude:34.004625,longitude:-81.03716},northmain:{address:"5306 N Main St, Columbia, SC 29203",latitude:34.052259,longitude:-81.021881},northeast:{address:"7490 Parklane Rd, Columbia, SC 29223",latitude:34.076023,longitude:-80.957776},sandhills:{address:"763 Fashion Drive, Columbia, SC 29229",
latitude:34.126491,longitude:-80.883608},southeast:{address:"7421 Garners Ferry Rd, Columbia, SC 29209",latitude:33.968516,longitude:-80.94607},standrews:{address:"2916 Broad River Rd, Columbia, SC 29210",latitude:34.047822,longitude:-81.102758},wheatley:{address:"931 Woodrow St, Columbia, SC 29205",latitude:34.002232,longitude:-81.005498}};void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180});
function haversine(c,b){var a=c.latitude.toRadians(),d=b.latitude.toRadians(),e=(b.latitude-c.latitude).toRadians(),f=(b.longitude-c.longitude).toRadians(),a=Math.sin(e/2)*Math.sin(e/2)+Math.cos(a)*Math.cos(d)*Math.sin(f/2)*Math.sin(f/2);return 12742E3*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}
jQuery.fn.sortElements=function(){var c=[].sort;return function(b,a){a=a||function(){return this};var d=this.map(function(){var c=a.call(this),b=c.parentNode,d=b.insertBefore(document.createTextNode(""),c.nextSibling);return function(){if(b===this)throw Error("You can't sort elements if any one is a descendant of another.");b.insertBefore(this,d);b.removeChild(d)}});return c.call(this,b).each(function(b){d[b].call(a.call(this))})}}();
window.getNearby=function(){void 0!==navigator&&navigator.geolocation.getCurrentPosition(function(c){for(key in branchLocations){var b=jQuery("#findYourLibrary_"+key),a=haversine(c.coords,branchLocations[key]);jQuery(b).data("distance",a);a*=6.21371192E-4;a*=10;a=Math.round(a)/10;b.children(".distance").text(a+"mi")}jQuery("#findYourLibrary_menu a").sortElements(function(a,b){return jQuery(a).data("distance")>jQuery(b).data("distance")?1:-1})},function(c){console.error(c)})};
